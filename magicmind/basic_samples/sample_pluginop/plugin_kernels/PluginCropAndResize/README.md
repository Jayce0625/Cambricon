# MagicMind API usage of PluginCropAndResize Operation

Table Of Contents
- [算子简介](#Brief-introduction-of-operation)
- [参数说明](#How-to-use-this-op)

## 算子原理

对输入的四通道图片，例如RGBA，进行裁剪和基于双线性插值算法的缩放。

## 用法说明

本节对算子接口中的参数进行详细说明。

### 输入说明

算子有四个输入张量，分别为：

- input: 代表输入图片的张量。维度数量必须为4，Layout必须为NHWC。数据类型必须为UINT8。

- crop_params: 代表用于裁剪的ROI信息的张量。维度数量必须为2，Layout必须为NT。其中N维度代表所有batch输入图片需要进行的裁剪次数之和。T维度必须为4，代表ROI由x，y，w，h四个数据表示。其中(x, y)代表ROI坐上角坐标，(x, y)代表ROI的宽和高。

- roi_nums: 代表每个batch输入图片进行裁剪次数的张量。维度数量必须为1，大小必须和input的N维度相同。算子使用roi_nums张量中的数据确定某个ROI框属于哪一个batch的输入图片。举例说明，假设roi_nums张量中的数据为1，2，3，4，则可知输入的四个batch图片会依次进行1，2，3，4次裁剪。因此crop_params形状为[10, 4]，其中[0:1, 4]属于第一张图片，[1:3,4]属于第二张图片，[3:6,4]属于第三张图片，[6:10,4]属于第四张图片。

- pad_values: 代表对输出图片进行填充的数据张量。当缩放过程需要符合保持长宽比时，输出图片的大小和实际有效图片的大小可以不相等。此时需要对无效数据部分进行填充。pad_values张量可以为任意维度，但是元素数量必须为4，代表输出图片中有效通道的填充值。举例说明，当输入图片形状为(1920, 1080)，输出图片形状为(720, 540)，且保持输入长宽比时，实际有效输出图片形状为(720, 405)。此时实际输出图片中的第406至540行会进行填充。有效图片始终位于实际输出图片的左上角。


### 输出说明

算子有一个输入张量，为：

- output: 代表输出图片的张量。维度数量必须为4，Layout必须为NHWC。形状由输入参数d_row，d_col决定。详见输入参数章节。

### 参数说明

算子有三个输入参数，分别为：

- d_row: 代表输出图片高度。

- d_col: 代表输出图片宽度。

- keep_aspect_ratio: 代表输出图片是否保持长宽比。0代表不保持，1代表保持。

### 平台限制

该算子支持370-S4, 370-X4和3226

